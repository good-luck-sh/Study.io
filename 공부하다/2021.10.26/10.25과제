--EMPLOYEES 테이블에서 이름이 8자인 직원들의 이름을 조회하기 
SELECT FIRST_NAME, LENGTH(FIRST_NAME) AS NAME_NUMBER
FROM EMPLOYEES
WHERE LENGTH(FIRST_NAME) = 8
ORDER BY LENGTH(FIRST_NAME) DESC;
--EMPLOYEES 테이블에서 이름이 8글자 이상인 직원들의 이름과 글자수를 조회하기 
SELECT FIRST_NAME, LENGTH(FIRST_NAME) AS NAME_LENGTH
FROM EMPLOYEES
WHERE LENGTH(FIRST_NAME) >= 8
ORDER BY LENGTH(FIRST_NAME) DESC;
--EMPLOYEES 테이블에서 직원의 이름을 전부 대문자로 변환했을 때 3번째 글자가 'E'인 모든 직원의 이름을 조회하기 
SELECT FIRST_NAME, UPPER(FIRST_NAME), SUBSTR(FIRST_NAME,1,3) ,INSTR(FIRST_NAME,'E')
FROM EMPLOYEES;

--EMPLOYEES 테이블에서 2007년도에 입사한 직원들의 직원아이디, 이름, 입사일을 조회하기 
SELECT EMPLOYEE_ID, FIRST_NAME, HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE >= '2007/01/01' AND HIRE_DATE <= '2007/12/31';
--EMPLOYEES 테이블에서 2005년에 입사한 직원 중에서 커미션을 받는 직원의 아이디, 이름, 급여, 커미션을 조회하기 
SELECT EMPLOYEE_ID, FIRST_NAME, SALARY, COMMISSION_PCT 
FROM EMPLOYEES
WHERE HIRE_DATE >= '2005/01/01' AND HIRE_DATE <= '2005/12/31' AND COMMISSION_PCT IS NOT NULL;
--EMPLOYEES 테이블에서 오늘이 입사일인 직원의 아이디, 이름, 입사일을 조회하기 
SELECT EMPLOYEE_ID, FIRST_NAME, HIRE_DATE
FROM EMPLOYEES 
WHERE HIRE_DATE = SYSDATE;
--EMPLOYEES 테이블에서 10월달에 입사한 모든 사원들의 아이디, 이름 입사일을 조회하기 
SELECT EMPLOYEE_ID, FIRST_NAME,HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE >= '%_/10/01' AND HIRE_DATE <= '%_/10/31';
--확인하기, 언제부터의 10월인지 문제가 이해가 가질 않음, 내가 생각하는 게 맞다면 다시 풀기
--EMPLOYEES 테이블에서 급여를 5000이상 받는 직원들의 아이디, 이름, 급여, 급여 등급을 조회하기 
--급여 등급 : 20000이상 A, 15000이상 B, 10000이상 C 그 외 D다 


SELECT EMPLOYEE_ID, FIRST_NAME, SALARY, 
CASE 
    WHEN SALARY >= 20000 THEN 'A'
    WHEN SALARY >= 15000 THEN 'B'
    WHEN SALARY >= 10000 THEN 'C'
    ELSE 'D'
    END AS "급여 등급"
FROM EMPLOYEES
WHERE SALARY >= 5000;

--EMPLOYEES 테이블에서 60번 부서에 소속된 사원들의 근무개월수를 오늘을 기준으로 계산해서 조회하기 
--직원아이디, 이름, 입사일, 근무개월수가 조회되어야하고, 근무개월수를 기준으로 오름차순으로 정렬한다. 
SELECT EMPLOYEE_ID, FIRST_NAME, HIRE_DATE, CEIL(MONTHS_BETWEEN(SYSDATE, HIRE_DATE)) AS "근무개월수"
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 60
ORDER BY HIRE_DATE DESC;

-- 사원의 이름과 급여를 표시하고, 급여에 대해서 #로 표시하기
-- '#'하나는 급여 1000에 해당한다.

-- 출력예시
-- 홍길동 4300 ####
-- 김유신 8700 ########
-- 강감찬 6500 ######
SELECT FIRST_NAME,SALARY,TO_CHAR(ROUND(SALARY/1000),'#') AS PAY 
FROM EMPLOYEES;


-- EMPLOYEES 테이블에서 2006년 상반기에 입사한 직원들의 직원아이디, 이름, 입사일, 연봉을 계산하기
-- 연봉은 급여*12 + 급여*커미션*12다.
SELECT EMPLOYEE_ID, FIRST_NAME, HIRE_DATE, SALARY, SALARY*12 + SALARY*12*NVL(COMMISSION_PCT,0) AS "연봉"
FROM EMPLOYEES
WHERE HIRE_DATE >= '2006/01/01' AND HIRE_DATE < '2006/07/01';

-- EMPLOYEES 테이블에서 100번 상사에게 보고하는 직원중에서 커미션을 받은 직원들의 직원아이디, 이름, 급여, 커미션을 조회하기
SELECT EMPLOYEE_ID, FIRST_NAME, SALARY, COMMISSION_PCT
FROM EMPLOYEES
WHERE MANAGER_ID = 100 AND COMMISSION_PCT IS NOT NULL;

-- EMPLOYEES 테이블에서 80번부서에 소속된 직원들의 평균급여, 최소급여, 최대급여를 조회하기
SELECT CEIL(AVG(SALARY)) AS AVERAGE, MIN(SALARY) AS MIN_SALARY , MAX(SALARY) AS MAX_SALARY
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 80;

-- EMPLOYEES 테이블에서 100번 상사에게 보고하는 직원의 수를 조회하기
SELECT COUNT(*) AS BOS_NUMBER_100
FROM EMPLOYEES
WHERE MANAGER_ID = 100;
